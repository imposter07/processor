{% extends "create_processor.html" %}

{% block app_content_3 %}
    <style type="text/css">
        .widget {
            height: 20vh !important;
            width: 175px;
            margin-left: auto;
            margin-right: auto;
        }

        .overlay {
            fill: none;
            pointer-events: all;
        }

        .radial-progress-bar {
            fill: #ddd;
            margin-left: auto;
            margin-right: auto;
            margin-top: auto;
        }

        .radial-progress-bar-bg {
            fill: #3f3f3f;
        }

        .progress-label {
            fill: #aaa;
            font-family: 'Open Sans', sans-serif;
            font-size: 15px;
            text-anchor: middle;
            dominant-baseline: central;
        }

        .outer {
            overflow: auto;
        }

        .icon-badge-container {
            position: relative;
            width: 10%;
        }

        .icon-badge {
            display: inline-block;
            background-color: red;
            font-size: 12px;
            color: white;
            text-align: center;
            position: absolute;
            border-radius: 80%;
        }

        .color-square:before {
            content: "";
            display: block;
            padding-top: 100%; /* initial ratio of 1:1*/
        }

        div[class*='zoom-out'] div[class*='card'] {
            zoom: 0.9;
        }
    </style>
    <nav>
        <div class="row">
            <div class="col-md-12 p-0">
                <div class="card-header">
                    <div class="nav nav-tabs" id="nav-tab" role="tablist">
                        <a class="nav-link d-flex align-items-center border text-secondary p-2 active" id="nav-dash-tab"
                           data-bs-toggle="tab" href="#nav-dash" role="tab"
                           aria-controls="nav-dash" aria-selected="true">
                            <h6 class="pl-1 pr-1 m-0 d-flex align-items-center">
                                <i class="bi bi-bar-chart-fill btn btn-secondary btn-sm mr-2"
                                   style="float:right;" aria-hidden="true"></i>
                                Topline
                            </h6>
                        </a>
                        <a class="nav-link d-flex align-items-center border text-secondary p-2" id="nav-partner-tab"
                           data-bs-toggle="tab" href="#nav-partner" role="tab"
                           aria-controls="nav-partner" aria-selected="true"
                           onclick="setTimeout(getPartnerMetrics, 1000);
                                 this.onclick=null;">
                            <h6 class="pl-1 pr-1 m-0 d-flex align-items-center">
                                <div hidden>
                                    <div id="pacingAlertCountProgress"></div>
                                </div>
                                <i class="bi bi-person-fill btn btn-secondary btn-sm mr-2"
                                   style="float:right;" aria-hidden="true"></i>
                                Partner
                                <div class="icon-badge-container align-self-baseline pl-1">
                                    <div class="icon-badge pl-1 pr-1"
                                         id="pacingAlertCount"></div>
                                </div>
                            </h6>
                        </a>
                        <a class="nav-link d-flex align-items-center border text-secondary p-2" id="nav-country-tab"
                           data-bs-toggle="tab" href="#nav-country" role="tab"
                           aria-controls="nav-country" aria-selected="true"
                           onclick="setTimeout(getCountryMetrics, 1000);
                                 this.onclick=null;">
                            <h6 class="pl-1 pr-1 m-0 d-flex align-items-center">
                                <i class="bi bi-globe btn btn-secondary btn-sm mr-2"
                                   style="float:right;" aria-hidden="true"></i>
                                Country
                            </h6>
                        </a>
                        <a class="nav-link d-flex align-items-center border text-secondary p-2" id="nav-targeting-tab"
                           data-bs-toggle="tab" href="#nav-targeting" role="tab"
                           aria-controls="nav-targeting" aria-selected="true"
                           onclick="setTimeout(getTargetingMetrics, 1000);
                                 this.onclick=null;">
                            <h6 class="pl-1 pr-1 m-0 d-flex align-items-center">
                                <i class="bi bi-bullseye btn btn-secondary btn-sm mr-2"
                                   style="float:right;" aria-hidden="true"></i>
                                Targeting
                            </h6>
                        </a>
                        <a class="nav-link d-flex align-items-center border text-secondary p-2" id="nav-placement-tab"
                           data-bs-toggle="tab" href="#nav-placement" role="tab"
                           aria-controls="nav-placement" aria-selected="true"
                           onclick="setTimeout(getPlacementMetrics, 1000);
                                 this.onclick=null;">
                            <h6 class="pl-1 pr-1 m-0 d-flex align-items-center">
                                <i class="bi bi-box btn btn-secondary btn-sm mr-2"
                                   style="float:right;" aria-hidden="true"></i>
                                Placement
                            </h6>
                        </a>
                        <a class="nav-link d-flex align-items-center border text-secondary p-2" id="nav-creative-tab"
                           data-bs-toggle="tab" href="#nav-creative" role="tab"
                           aria-controls="nav-creative" aria-selected="true"
                           onclick="setTimeout(getCreativeMetrics, 1000);
                                 this.onclick=null;">
                            <h6 class="pl-1 pr-1 m-0 d-flex align-items-center">
                                <i class="bi bi-image btn btn-secondary btn-sm mr-2"
                                   style="float:right;" aria-hidden="true"></i>
                                Creative
                            </h6>
                        </a>
                        <a class="nav-link d-flex align-items-center border text-secondary p-2" id="nav-billing-tab"
                           data-bs-toggle="tab" href="#nav-billing" role="tab"
                           aria-controls="nav-billing" aria-selected="true">
                            <h6 class="pl-1 pr-1 m-0 d-flex align-items-center">
                                <i class="bi bi-cash btn btn-secondary btn-sm mr-2"
                                   style="float:right;" aria-hidden="true"></i>
                                Billing
                            </h6>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <div class="tab-content" id="nav-dash-tabContent">
        <div class="tab-pane fade show active" id="nav-dash"
             role="tabpanel" aria-labelledby="nav-dash-tab">
            <div class="row">
                <div class="col-md-12 p-0">
                    <div class="card-header">
                        <div class="row" id="navRow">
                            <div class="btn-group btn-group-sm w-100"
                                 role="group">
                                <button id="getAllCharts"
                                        class="btn btn-outline-primary"><i
                                        class="bi bi-bar-chart" href="#"
                                        role="button"
                                        aria-hidden="true"></i>Get All Charts
                                </button>
                            </div>
                        </div>
                        <div class="row" id="filterRow" hidden="">
                            <div class="col mb-3">
                                <select id="campaignnameSelect" multiple=""
                                        class="form-control form-control-sm">
                                    <option value="">Campaign</option>
                                </select>
                            </div>
                            <div class="col mb-3">
                                <select id="vendornameSelect" multiple=""
                                        class="form-control form-control-sm">
                                    <option value="">Vendor</option>
                                </select>
                            </div>
                            <div class="col mb-3">
                                <select id="countrynameSelect" multiple=""
                                        class="form-control form-control-sm">
                                    <option value="">Country</option>
                                </select>
                            </div>
                            <div class="col mb-3">
                                <select id="environmentnameSelect" multiple=""
                                        class="form-control form-control-sm">
                                    <option value="">Environment</option>
                                </select>
                            </div>
                            <div class="col mb-3">
                                <select id="kpinameSelect" multiple=""
                                        class="form-control form-control-sm">
                                    <option value="">KPI</option>
                                </select>
                            </div>
                            <div class="col mb-3">
                                <div class="row">
                                    <input id="datePicker"
                                           class="custom-select custom-select-sm
                                                  flatpickr flatpickr-input active"
                                           type="text" placeholder="Date"
                                           data-id="range"
                                           readonly="readonly" data-input>
                                </div>
                            </div>
                            <div class="col mb-3">
                                <button id="applyFilter" type="button"
                                        class="btn w-100 btn-outline-primary btn-sm">
                                    Apply Filter
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <br>
            <div class="row">
                <button class="btn btn-success ml-3 text-right" id="add-dash">
                    <i class="bi bi-plus" style="color:white" onclick="addDashModal('Topline')"></i>
                </button>
                <div class="col-md-12 h-50">
                    <div class="card-group container-fluid text-center mx-auto mb-2 mt-2">
                        <div id="totalMetricsProgress"></div>
                        <div id="totalMetrics" class="row w-100 mx-auto"></div>
                    </div>
                </div>
            </div>

            <br>
            <div class="row h-80">
                <div class="col-md-4 h-80">
                    <div id="toplineMetrics"
                         class="card shadow-sm outer remove-items-shadow zoom-out
                                remove-internal-padding"
                         style="height:755px"></div>
                    <div class="d-none">
                        <div id="toplineMetricsProgress"></div>
                    </div>
                </div>
                <div class="col-md-8 h-80  vertical-center">
                    <div class="card-header d-flex flex-row rounded align-items-center">
                        <h7 class="pr-2 mr-5">Daily</h7>
                        <div class="col-sm d-flex align-center">
                            <div class="col-xs-4  color-square p-2 border"
                                 id="dailyMetricsChartPlaceholderSelect0Key"></div>
                        </div>
                        <select id="dailyMetricsChartPlaceholderSelect0"
                                class="form-control form-control-sm p-1 mr-4">
                        </select>
                        <div class="col-sm d-flex align-center">
                            <div class="col-xs-4  color-square pl-4 pt-1"
                                 id="dailyMetricsChartPlaceholderSelect1Key"></div>
                        </div>
                        <select id="dailyMetricsChartPlaceholderSelect1"
                                class="form-control form-control-sm p-1">
                        </select>
                    </div>
                    <div class="card container-fluid shadow-sm outer p-0 remove-items-shadow"
                         style="overflow-x: hidden">
                        <div id="dailyMetricsProgress"></div>
                        <div id="dailyMetrics"
                             style="height: 480px; width: 97%"></div>
                        <div class="card-body container-fluid p-0 mt-3">
                            <div style="height: 190px" class="p-3">
                                <div id="dailyMetricsNotesProgress"></div>
                                <div id="dailyMetricsNotes">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-4 h-75">
                    <div class="card-header d-flex flex-row rounded"
                         style="height:61px">
                        <h7 class="pr-4">Delivery</h7>
                    </div>
                    <div class="card container-fluid shadow-sm outer p-0 remove-items-shadow">
                        <div id="deliveryMetricsProgress"></div>
                        <div id="deliveryMetrics" style="height:330px;"></div>
                    </div>
                </div>
                <div class="col-md-8 h-50">
                    <div class="card-header d-flex flex-row rounded">
                        <h7 class="pr-4">Partner</h7>
                        <select id="partnerMetricsChartPlaceholderSelect"
                                class="form-control form-control-sm">
                        </select>
                    </div>
                    <div class="card container-fluid shadow-sm outer p-0 remove-items-shadow">
                        <div id="partnerMetricsProgress"></div>
                        <div id="partnerMetrics"></div>
                    </div>
                </div>
                <br>
            </div>
            <div id="customChartsTopline" class="container-fluid" style="min-height: 200px"></div>
            <br>
            <div class="row" id="thirdRow" hidden="">
                <div class="col-md-7 h-50">
                    <div class="card-header d-flex flex-row rounded">
                        <h7 class="pr-4">Country</h7>
                        <select id="countryMetricsChartPlaceholderSelect"
                                class="form-control form-control-sm">
                        </select>
                    </div>
                    <div class="card container-fluid shadow-sm outer p-0 remove-items-shadow">
                        <div id="countryMetricsProgress"></div>
                        <div id="countryMetrics"></div>
                    </div>
                </div>
                <div class="col-md-5 h-50">
                    <div class="card-header d-flex flex-row rounded">
                        <h7 class="pr-4">Campaign</h7>
                        <select id="campaignMetricsChartPlaceholderSelect"
                                class="form-control form-control-sm">
                        </select>
                    </div>
                    <div class="card container-fluid shadow-sm outer p-0 remove-items-shadow">
                        <div id="campaignMetricsProgress"></div>
                        <div id="campaignMetrics"></div>
                    </div>
                </div>
            </div>
            <br>
            <div class="row" id="fourthRow" hidden="">
                <div class="col-md-5 h-50">
                    <div class="card-header d-flex flex-row rounded">
                        <h7 class="pr-4">Device</h7>
                        <select id="environmentMetricsChartPlaceholderSelect"
                                class="form-control form-control-sm">
                        </select>
                    </div>
                    <div class="card container-fluid shadow-sm outer p-0 remove-items-shadow">
                        <div id="environmentMetricsProgress"></div>
                        <div id="environmentMetrics"></div>
                    </div>
                </div>
                <div class="col-md-7 h-50">
                    <div class="card-header d-flex flex-row rounded">
                        <h7 class="pr-4">KPI</h7>
                        <select id="kpiMetricsChartPlaceholderSelect"
                                class="form-control form-control-sm">
                        </select>
                    </div>
                    <div class="card container-fluid shadow-sm outer p-0 remove-items-shadow">
                        <div id="kpiMetricsProgress"></div>
                        <div id="kpiMetrics"></div>
                    </div>
                </div>
            </div>
        </div>
        {% include 'dashboards/partner.html' %}
        {% include 'dashboards/country.html' %}
        {% include 'dashboards/targeting.html' %}
        {% include 'dashboards/placement.html' %}
        {% include 'dashboards/creative.html' %}
        <div class="tab-pane fade show" id="nav-billing" role="tabpanel"
             aria-labelledby="nav-dash-tab"></div>
        <div class="row">
            <div id="billingTable"></div>
        </div>
    </div>


    <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
    <script src="{{ url_for('static', filename='js_utils.js') }}"></script>
    <script src="{{ url_for('static', filename='liquid_table.js') }}"></script>
    <script src="{{ url_for('static', filename='get_table.js') }}"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            addOnClickEvent('button[id^="getAllCharts"]', getAllChartsClickEvent);
            addOnClickEvent('button[id^="applyFilter"]', applyFilterEvent);
            addOnClickEvent('[id^="nav-billing-tab"]', getBillingTable);
            window.addEventListener('scroll', function () {
                getTabCharts();
            });
            window.addEventListener('resize', function () {
                getTabCharts();
            });
            addSelectize();
            $("#datePicker").flatpickr({
                mode: "range"
            });
            getAllCharts();
        });
    </script>
    {% include "dashboards/_dash_builder.html" %}
    {% include "_table_builder.html" %}
    {% include "_report_builder.html" %}
    {% include "_select_builder.html" %}
    {% include "_rawfile_check.html" %}
{% endblock %}